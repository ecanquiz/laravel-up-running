import{_ as s,c as a,o as i,V as e}from"./chunks/framework.D9sOcAzr.js";const g=JSON.parse('{"title":"Directivas Blade Personalizadas","description":"","frontmatter":{},"headers":[],"relativePath":"blade-templating/custom-blade-directives.md","filePath":"blade-templating/custom-blade-directives.md"}'),n={name:"blade-templating/custom-blade-directives.md"},t=e(`<h1 id="directivas-blade-personalizadas" tabindex="-1">Directivas Blade Personalizadas <a class="header-anchor" href="#directivas-blade-personalizadas" aria-label="Permalink to &quot;Directivas Blade Personalizadas&quot;">​</a></h1><p>Toda la sintaxis incorporada de Blade que hemos cubierto hasta ahora — <code>@if</code>, <code>@unless</code>, etc. — se denomina <em>directivas</em>. Cada directiva de Blade es una asignación entre un patrón (por ejemplo, <code>@if ($condition)</code>) y una salida PHP (por ejemplo, <code>&lt;?php if ($condition): ?&gt;</code>).</p><p>Las directivas no son solo para el núcleo; de hecho, puedes crear las tuyas propias. Podrías pensar que las directivas son buenas para crear pequeños atajos a fragmentos de código más grandes — por ejemplo, usar <code>@button(&#39;buttonName&#39;)</code> y hacer que se expanda a un conjunto más grande de botones HTML. Esta no es una mala idea, pero para una expansión de código simple como esta, tal vez sea mejor incluir una vista parcial.</p><p>Las directivas personalizadas suelen ser más útiles cuando simplifican alguna forma de lógica repetida. Digamos que estamos cansados ​​de tener que encapsular nuestro código con <code>@if (auth()-&gt;guest())</code> (para comprobar si un usuario ha iniciado sesión o no) y queremos una directiva <code>@ifGuest</code> personalizada. Al igual que con los compositores de vistas, podría valer la pena tener un proveedor de servicios personalizado para registrarlos, pero por ahora, simplemente pongámoslo en el método <code>boot()</code> de <code>App\\Providers\\AppServiceProvider</code>. Eche un vistazo al ejemplo siguiente para ver cómo se verá esta vinculación.</p><p><em>Vinculación de una directiva Blade personalizada en un proveedor de servicios</em></p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> boot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Blade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ifGuest&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;?php if (auth()-&gt;guest()): ?&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Ahora hemos registrado una directiva personalizada, <code>@ifGuest</code>, que será reemplazada por el código PHP <code>&lt;?php if (auth()-&gt;guest()): ?&gt;</code>.</p><p>Puede que esto te parezca extraño. Estás escribiendo una <em>cadena</em> que se devolverá y luego se ejecutará como PHP. Pero lo que esto significa es que ahora puedes tomar los aspectos complejos, feos, poco claros o repetitivos de tu código de plantilla PHP y ocultarlos detrás de una sintaxis clara, simple y expresiva.</p><div class="info custom-block"><p class="custom-block-title">Almacenamiento en Caché de Resultados de Directivas Personalizadas</p><p>Es posible que sienta la tentación de aplicar algo de lógica para que su directiva personalizada sea más rápida realizando una operación en el vínculo y luego incorporando el resultado dentro de la cadena devuelta:</p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Blade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ifGuest&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Antipattern! Do not copy.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $ifGuest </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">guest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;?php if ({</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ifGuest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}): ?&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>El problema con esta idea es que supone que esta directiva se volverá a crear en cada carga de página. Sin embargo, Blade almacena en caché de forma agresiva, por lo que te encontrarás en una mala situación si intentas esto.</p></div><h2 id="parametros-en-directivas-de-blade-personalizadas" tabindex="-1">Parámetros en Directivas de Blade Personalizadas <a class="header-anchor" href="#parametros-en-directivas-de-blade-personalizadas" aria-label="Permalink to &quot;Parámetros en Directivas de Blade Personalizadas&quot;">​</a></h2><p>¿Qué sucede si desea aceptar parámetros en su lógica personalizada? Consulte el ejemplo siguiente.</p><p><em>Creación de una directiva Blade con parámetros</em></p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Binding</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Blade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;newlinesToBr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($expression) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;?php echo nl2br({</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$expression</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}); ?&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- In use --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;@newlinesToBr($message-&gt;body)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">p</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>El parámetro <code>$expression</code> que recibe la clausura representa lo que está dentro de los paréntesis. Como puede ver, generamos un fragmento de código PHP válido y lo devolvemos.</p><p>Si se encuentra escribiendo constantemente la misma lógica condicional una y otra vez, debería considerar una directiva Blade.</p><h2 id="ejemplo-usando-directivas-blade-personalizadas-para-una-aplicacion-multitenant" tabindex="-1">Ejemplo: Usando Directivas Blade Personalizadas para una Aplicación <em>Multitenant</em> <a class="header-anchor" href="#ejemplo-usando-directivas-blade-personalizadas-para-una-aplicacion-multitenant" aria-label="Permalink to &quot;Ejemplo: Usando Directivas Blade Personalizadas para una Aplicación  _Multitenant_&quot;">​</a></h2><p>Imaginemos que estamos creando una aplicación que admite <em>multitenancy</em>, lo que significa que los usuarios podrían visitar el sitio desde <code>www.myapp.com</code>, <code>client1.myapp.com</code>, <code>client2.myapp.com</code> o desde otro lugar.</p><p>Supongamos que hemos escrito una clase para encapsular parte de nuestra lógica <em>multitenancy</em> y la hemos llamado <code>Context</code>. Esta clase capturará información y lógica sobre el contexto de la visita actual, como quién es el usuario autenticado y si el usuario está visitando el sitio web público o un subdominio de cliente.</p><p>Probablemente resolveremos con frecuencia esa clase <code>Context</code> en nuestras vistas y ejecutaremos condicionales en ella, como en el ejemplo siguiente. <code>app(&#39;context&#39;)</code> es un atajo para obtener una instancia de una clase del contenedor, sobre lo cual aprenderemos más en <a href="./../the-container/a-quick-intro-to-dependency-injection.html#el-contenedor">El Contenedor</a>.</p><p><em>Condicionales en contexto sin una directiva Blade personalizada</em></p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@if (app(&#39;context&#39;)-&gt;isPublic())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &amp;copy;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Copyright MyApp LLC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &amp;copy;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Copyright {{ app(&#39;context&#39;)-&gt;client-&gt;name }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@endif</span></span></code></pre></div><p>¿Qué pasaría si pudiéramos simplificar <code>@if (app(&#39;context&#39;)-&gt;isPublic())</code> a simplemente <code>@ifPublic</code>? Hagámoslo. Veamos el ejemplo siguiente.</p><p><em>Condicionales en contexto con una directiva Blade personalizada</em></p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Binding</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Blade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">directive</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ifPublic&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&lt;?php if (app(&#39;context&#39;)-&gt;isPublic()): ?&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- In use --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@ifPublic</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &amp;copy;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Copyright MyApp LLC</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@else</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &amp;copy;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Copyright {{ app(&#39;context&#39;)-&gt;client-&gt;name }}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@endif</span></span></code></pre></div><p>Dado que esto se resuelve en una simple declaración <code>if</code>, aún podemos confiar en las condiciones nativas <code>@else</code> y <code>@endif</code>. Pero si quisiéramos, también podríamos crear una directiva <code>@elseIfClient</code> personalizada, o una directiva <code>@ifClient</code> separada, o realmente cualquier otra cosa que queramos.</p><h2 id="directivas-personalizadas-mas-faciles-para-declaraciones-if" tabindex="-1">Directivas Personalizadas Más Fáciles para Declaraciones <code>if</code> <a class="header-anchor" href="#directivas-personalizadas-mas-faciles-para-declaraciones-if" aria-label="Permalink to &quot;Directivas Personalizadas Más Fáciles para Declaraciones \`if\`&quot;">​</a></h2><p>Aunque las directivas Blade personalizadas son potentes, el uso más común para ellas son las instrucciones <code>if</code>. Por lo tanto, existe una forma más sencilla de crear directivas <code>if</code> personalizadas: <code>Blade::if()</code>. El ejemplo siguiente muestra cómo podríamos refactorizar el ejemplo anterior utilizando el método <code>Blade::if()</code>:</p><p><em>Definición de una directiva Blade “if” personalizada</em></p><div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Binding</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Blade</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ifPublic&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;context&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isPublic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p>Usarás las directivas exactamente de la misma manera, pero como puedes ver, definirlas es un poco más simple. En lugar de tener que escribir manualmente las llaves PHP, puedes escribir una clausura que devuelva un valor Booleano.</p>`,32),l=[t];function p(o,d,r,h,c,k){return i(),a("div",null,l)}const E=s(n,[["render",p]]);export{g as __pageData,E as default};
